diff --git a/vl.c b/vl.c
index 1eaedd4..a0fe73d 100644
--- a/vl.c
+++ b/vl.c
@@ -6095,9 +6095,10 @@ geometry_error:
 		    xenstore_read_vncpasswd(domid, password, sizeof(password));
 		    vnc_display_password(ds, password);
                     if (vncunused) {
-                        char *display = malloc(strlen(vnc_display) + 7);
-                        snprintf(display, strlen(vnc_display) + 7, "%s,to=99999", vnc_display);
+                        char *display = malloc(strlen(vnc_display) + 10);
+                        snprintf(display, strlen(vnc_display) + 10, "%s,to=99999", vnc_display);
                         vnc_display_port = vnc_display_open(ds, display);
+                        free(display);
                     } else
                         vnc_display_port = vnc_display_open(ds, vnc_display);
 		    if (vnc_display_port < 0)
